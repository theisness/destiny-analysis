# 快速开始指南

## 🚀 快速启动

### Windows 用户
双击运行 `start.bat` 文件，按提示选择启动方式。

### Mac/Linux 用户
```bash
chmod +x start.sh
./start.sh
```

## 📋 启动方式

### 方式一：Docker Compose（推荐）

**优点：**
- 一键启动所有服务
- 无需手动配置环境
- 自动处理依赖关系

**前提条件：**
- 已安装 Docker Desktop

**步骤：**
1. 运行启动脚本，选择选项 1
2. 等待容器构建和启动（首次需要几分钟）
3. 访问 http://localhost:3000

**管理命令：**
```bash
# 查看日志
docker-compose logs -f

# 停止服务
docker-compose down

# 重启服务
docker-compose restart

# 查看运行状态
docker-compose ps
```

### 方式二：本地开发模式

**优点：**
- 热重载，实时看到代码变化
- 便于调试

**前提条件：**
- Node.js 18+
- Docker Desktop（用于运行 MongoDB）

**步骤：**

1. **自动启动 MongoDB**

启动脚本会自动检查并启动 MongoDB Docker 容器！
- 如果容器不存在，自动创建
- 如果容器存在但未运行，自动启动
- 如果已经运行，直接使用

```bash
# 容器信息
容器名称: destiny-mongo
连接地址: mongodb://localhost:27017/destiny-analysis
数据卷: destiny-mongo-data（数据持久化）

# 管理命令（可选）
docker logs destiny-mongo      # 查看日志
docker stop destiny-mongo       # 停止容器
docker start destiny-mongo      # 启动容器
docker rm destiny-mongo         # 删除容器
docker volume rm destiny-mongo-data  # 删除数据
```

2. **运行启动脚本**

启动脚本会自动完成以下操作：
- ✅ 检查并启动 MongoDB Docker 容器
- ✅ 自动配置后端环境变量（backend/.env）
- ✅ 自动配置前端环境变量（frontend/.env，可选）
- ✅ 安装所有 NPM 依赖
- ✅ 启动前后端开发服务器

**Windows：**
```bash
双击 start.bat，选择选项 2
```

**Mac/Linux：**
```bash
chmod +x start.sh
./start.sh  # 选择选项 2
```

3. **访问应用**
- 前端：http://localhost:3000
- 后端API：http://localhost:5000

**注意：** 
- ✅ 启动脚本会自动创建配置文件
- ✅ 后端配置（backend/.env）- 必需，自动创建
- ✅ 前端配置（frontend/.env）- 可选，自动创建（有默认值）
- ✅ 无需手动配置！

## 🎯 首次使用

1. **注册账户**
   - 访问 http://localhost:3000
   - 点击"立即注册"
   - 输入用户名、邮箱、密码

2. **登录系统**
   - 使用注册的邮箱和密码登录

3. **创建八字排盘**
   - 点击"新建排盘"
   - 选择输入方式（公历/农历/四柱）
   - 填写个人信息
   - 点击"计算八字"

4. **查看详情**
   - 在仪表盘点击记录卡片
   - 查看完整的八字分析

5. **分享到社区**
   - 在创建时勾选"添加到讨论社区"
   - 在社区页面浏览其他人的八字

## 🔧 故障排除

### 端口被占用

**问题：** 启动失败，提示端口已被使用

**解决：**
```bash
# Windows - 查找占用端口的进程
netstat -ano | findstr :3000
netstat -ano | findstr :5000
netstat -ano | findstr :27017

# 杀死进程（替换 PID）
taskkill /PID <PID> /F

# Mac/Linux
lsof -ti:3000 | xargs kill
lsof -ti:5000 | xargs kill
lsof -ti:27017 | xargs kill
```

### MongoDB 连接失败

**问题：** 后端无法连接 MongoDB

**解决：**
1. 确认 MongoDB 正在运行
2. 检查 `backend/.env` 中的 `MONGODB_URI`
3. 如使用 Docker：`docker ps` 确认 mongo 容器运行中

### 前端无法访问后端

**问题：** 前端报 API 连接错误

**解决：**
1. 确认后端正在运行（访问 http://localhost:5000）
2. 检查 `frontend/package.json` 中的 `proxy` 设置
3. 检查 `frontend/.env` 中的 `REACT_APP_API_URL`
4. 清除浏览器缓存并刷新

### 如何修改前端端口

**问题：** 3000 端口被占用或想使用其他端口

**解决：**
1. 修改 `frontend/.env` 文件中的 `PORT` 配置
2. 重启开发服务器

**示例：**
```env
PORT=8080
```

详见 [端口配置快速参考.md](./端口配置快速参考.md)

### Docker 构建失败

**问题：** docker-compose 构建报错

**解决：**
```bash
# 清理 Docker 缓存
docker-compose down -v
docker system prune -a

# 重新构建
docker-compose up -d --build
```

## 📱 测试账号（可选）

您可以使用以下测试账号快速体验：

```
邮箱：test@example.com
密码：test123456
```

**注意：** 首次启动时数据库为空，需要先注册账号。

## 🎨 功能演示

### 1. 公历输入示例
```
姓名：张三
性别：男
公历：1990年5月15日 10:30
```

### 2. 农历输入示例
```
姓名：李四
性别：女
农历：1990年四月二十一 12:00
闰月：否
```

### 3. 四柱输入示例
```
姓名：王五
性别：男
年柱：庚午
月柱：辛巳
日柱：甲子
时柱：丙寅
```

## 📚 更多信息

详细的使用说明和API文档请查看 [README.md](./README.md)

## 🐛 问题反馈

如遇到问题，请：
1. 查看控制台日志
2. 检查浏览器开发者工具
3. 提交 Issue 并附上错误信息

---

**祝您使用愉快！** 🎉

